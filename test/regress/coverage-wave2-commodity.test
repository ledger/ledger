; Tests for commodity.cc uncovered lines
; Covers: add_price (line 50-51), find_price (line 121, 140),
;   parse_symbol (lines 309-321), valid() (lines 338-349),
;   compare_by_commodity with annotations (lines 384-505)

P 2024/01/01 AAPL $150.00
P 2024/01/02 AAPL $155.00
P 2024/01/03 AAPL $160.00

2024/01/01 Buy AAPL
    Assets:Brokerage        10 AAPL
    Assets:Cash            $-1500.00

; Test pricedb output - covers add_price
test prices AAPL
24-Jan-01 AAPL          $150.00
24-Jan-02 AAPL          $155.00
24-Jan-03 AAPL          $160.00
end test

; Test comparing annotated commodities with different prices - covers lines 383-410
2024/01/04 Buy More
    Assets:Lots          5 AAPL {$150.00}
    Assets:Cash

2024/01/05 Buy Even More
    Assets:Lots          5 AAPL {$160.00}
    Assets:Cash

test bal --flat --lots Assets:Lots
    5 AAPL {$150.00}
    5 AAPL {$160.00}  Assets:Lots
end test

; Test nomarket commodity
commodity BOND
    nomarket

2024/01/06 Buy Bond
    Assets:Bonds          100 BOND
    Assets:Cash

test bal Assets:Bonds
            100 BOND  Assets:Bonds
end test

; Test complex expressions to exercise op.cc, token.cc, and expr.cc
; (exercises comparison operators, logical operators, regex matching,
;  date literals, negation, equality/inequality)

2024/01/15 * Grocery Store
    Expenses:Food:Groceries   $50.00
    Assets:Checking

2024/02/10 * Electric Company
    Expenses:Utilities:Electric  $120.00
    Assets:Checking

2024/03/20 * Restaurant
    Expenses:Food:Dining     $35.00
    Assets:Checking

2024/04/05 * Gas Station
    Expenses:Transport:Gas    $45.00
    Assets:Checking

2024/06/01 * Landlord
    Expenses:Housing:Rent    $1200.00
    Assets:Checking

test reg --limit "amount > 100 and account =~ /Expenses/"
24-Feb-10 Electric Company      Exp:Utilities:Electric      $120.00      $120.00
24-Jun-01 Landlord              Expenses:Housing:Rent      $1200.00     $1320.00
end test

test reg --limit "date >= [2024/03/01] and date < [2024/05/01]"
24-Mar-20 Restaurant            Expenses:Food:Dining         $35.00       $35.00
                                Assets:Checking             $-35.00            0
24-Apr-05 Gas Station           Expenses:Transport:Gas       $45.00       $45.00
                                Assets:Checking             $-45.00            0
end test

test reg --limit "account =~ /Food/ or account =~ /Transport/"
24-Jan-15 Grocery Store         Expense:Food:Groceries       $50.00       $50.00
24-Mar-20 Restaurant            Expenses:Food:Dining         $35.00       $85.00
24-Apr-05 Gas Station           Expenses:Transport:Gas       $45.00      $130.00
end test

test reg --limit "amount < -100"
24-Feb-10 Electric Company      Assets:Checking            $-120.00     $-120.00
24-Jun-01 Landlord              Assets:Checking           $-1200.00    $-1320.00
end test

test reg --limit "!(payee =~ /Restaurant/)"
24-Jan-15 Grocery Store         Expense:Food:Groceries       $50.00       $50.00
                                Assets:Checking             $-50.00            0
24-Feb-10 Electric Company      Exp:Utilities:Electric      $120.00      $120.00
                                Assets:Checking            $-120.00            0
24-Apr-05 Gas Station           Expenses:Transport:Gas       $45.00       $45.00
                                Assets:Checking             $-45.00            0
24-Jun-01 Landlord              Expenses:Housing:Rent      $1200.00     $1200.00
                                Assets:Checking           $-1200.00            0
end test

test reg --limit "!(amount < 0)"
24-Jan-15 Grocery Store         Expense:Food:Groceries       $50.00       $50.00
24-Feb-10 Electric Company      Exp:Utilities:Electric      $120.00      $170.00
24-Mar-20 Restaurant            Expenses:Food:Dining         $35.00      $205.00
24-Apr-05 Gas Station           Expenses:Transport:Gas       $45.00      $250.00
24-Jun-01 Landlord              Expenses:Housing:Rent      $1200.00     $1450.00
end test

test reg --limit 'amount == $50'
24-Jan-15 Grocery Store         Expense:Food:Groceries       $50.00       $50.00
end test

test reg --limit 'amount != $50 and !(amount < 0)'
24-Feb-10 Electric Company      Exp:Utilities:Electric      $120.00      $120.00
24-Mar-20 Restaurant            Expenses:Food:Dining         $35.00      $155.00
24-Apr-05 Gas Station           Expenses:Transport:Gas       $45.00      $200.00
24-Jun-01 Landlord              Expenses:Housing:Rent      $1200.00     $1400.00
end test

test reg --format "%(justify(scrub(display_amount), 20, -1, true, color))\n"
              $50.00
             $-50.00
             $120.00
            $-120.00
              $35.00
             $-35.00
              $45.00
             $-45.00
            $1200.00
           $-1200.00
end test

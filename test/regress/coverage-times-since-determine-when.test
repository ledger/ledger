; Test since/until/from/in with this/next/last to exercise determine_when()
; These go through handle_since_token/handle_until_token/handle_in_token
; which call determine_when() with TOK_THIS/TOK_NEXT/TOK_LAST, unlike
; standalone "this/next/last" which go through handle_relative_token.
;
; Exercises determine_when lines 772-851:
;   TOK_THIS/NEXT/LAST + TOK_YEAR (lines 798-802)
;   TOK_THIS/NEXT/LAST + TOK_QUARTER (lines 805-817)
;   TOK_THIS/NEXT/LAST + TOK_WEEK (lines 820-832)
;   TOK_THIS/NEXT/LAST + TOK_DAY (lines 835-839)
;   TOK_THIS/NEXT/LAST + TOK_MONTH (lines 843-848)
;   TOK_THIS/NEXT/LAST + TOK_A_MONTH (lines 781-786)
; Also exercises handle_since_token (lines 916-924)
;   handle_until_token (lines 927-935)
;   handle_in_token (lines 938-946)

2024/01/15 Payee A
    Expenses:Food    $50.00
    Assets:Checking

2024/03/20 Payee B
    Expenses:Rent    $1000.00
    Assets:Checking

2024/06/10 Payee C
    Expenses:Transport    $75.00
    Assets:Checking

2024/08/05 Payee D
    Expenses:Utilities    $120.00
    Assets:Checking

; "since this year" → determine_when TOK_THIS + TOK_YEAR
test reg --now 2024/06/15 --period "since this year" Expenses
24-Jan-15 Payee A               Expenses:Food                $50.00       $50.00
24-Mar-20 Payee B               Expenses:Rent              $1000.00     $1050.00
24-Jun-10 Payee C               Expenses:Transport           $75.00     $1125.00
24-Aug-05 Payee D               Expenses:Utilities          $120.00     $1245.00
end test

; "from last month until next day" → determine_when TOK_LAST+TOK_MONTH, TOK_NEXT+TOK_DAY
test reg --now 2024/06/15 --period "from last month until next day"
24-Jun-10 Payee C               Expenses:Transport           $75.00       $75.00
                                Assets:Checking             $-75.00            0
end test

; "since this week" → determine_when TOK_THIS + TOK_WEEK
test reg --now 2024/06/15 --period "since this week"
end test

; "since this day" → determine_when TOK_THIS + TOK_DAY
test reg --now 2024/06/10 --period "since this day"
24-Jun-10 Payee C               Expenses:Transport           $75.00       $75.00
                                Assets:Checking             $-75.00            0
24-Aug-05 Payee D               Expenses:Utilities          $120.00      $120.00
                                Assets:Checking            $-120.00            0
end test

; "from last month" → determine_when TOK_LAST + TOK_MONTH (default case)
test reg --now 2024/01/15 --period "from last month" Expenses
24-Jan-15 Payee A               Expenses:Food                $50.00       $50.00
24-Mar-20 Payee B               Expenses:Rent              $1000.00     $1050.00
24-Jun-10 Payee C               Expenses:Transport           $75.00     $1125.00
24-Aug-05 Payee D               Expenses:Utilities          $120.00     $1245.00
end test

; "since next january" → determine_when TOK_NEXT + TOK_A_MONTH
test reg --now 2024/06/15 --period "since next january" Expenses
end test

; "in this month" → determine_when TOK_THIS + TOK_MONTH via handle_in_token
test reg --now 2024/06/15 --period "in this month"
24-Jun-10 Payee C               Expenses:Transport           $75.00       $75.00
                                Assets:Checking             $-75.00            0
end test

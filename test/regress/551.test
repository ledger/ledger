; Test for issue #551
; Multiple PRs address this: #93, #94, #95, #115, #122
; https://github.com/ledger/ledger/issues/551
; Conflicting options --budget and --invert
; The bug was that when using --budget with --invert, the cumulative
; column showed incorrect values

~ Weekly
    Expenses:Stuff          80.00 USD
    Income:Budget

2024/01/01 Test1
    Expenses:Stuff          100.00 USD
    Assets:Checking

2024/01/08 Test2
    Expenses:Stuff          50.00 USD
    Assets:Checking

; Test --budget without --invert (should show over/under budget)
test reg Stuff --budget -W -e 2024/01/15
23-Dec-31 - 24-Jan-06           Expenses:Stuff            20.00 USD    20.00 USD
24-Jan-07 - 24-Jan-13           Expenses:Stuff           -30.00 USD   -10.00 USD
24-Jan-14 - 24-Jan-20           Expenses:Stuff           -80.00 USD   -90.00 USD
end test

; Test --budget WITH --invert (the bug scenario)
; After fix: amounts should be inverted AND running total should be correct
test reg Stuff --budget --invert -W -e 2024/01/15
23-Dec-31 - 24-Jan-06           Expenses:Stuff           -20.00 USD   -20.00 USD
24-Jan-07 - 24-Jan-13           Expenses:Stuff            30.00 USD    10.00 USD
24-Jan-14 - 24-Jan-20           Expenses:Stuff            80.00 USD    90.00 USD
end test

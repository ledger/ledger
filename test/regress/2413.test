# Test case from issue #2413
# The xact command should use the last year directive (2025) when creating
# a new transaction with a partial date like "03-03"
#
# This test reproduces the exact examples from the issue report:
# https://github.com/ledger/ledger/issues/2413

# First example from the issue: multiple year directives
year 2021
year 2022
year 2023

year 2024
2024-03-03=03-07 * Shop  ; for =2024-03-07
    Expenses:Food                                 $9.00
    Account

year 2025
2025-03-03=03-06 Shop    ; for =2025-03-06
    Expenses:Food                                $10.00
    Account

test reg --effective
24-Mar-07 Shop                  Expenses:Food                 $9.00        $9.00
                                Account                      $-9.00            0
25-Mar-06 Shop                  Expenses:Food                $10.00       $10.00
                                Account                     $-10.00            0
end test

# The issue author expected 2025 for both 03-03 and 03/03 formats
test xact 03-03 Shop 10
2025/03/03 Shop  ; for =2025-03-06
    Expenses:Food                             $10.00
    Account
end test

test xact 03/03 Shop 10
2025/03/03 Shop  ; for =2025-03-06
    Expenses:Food                             $10.00
    Account
end test